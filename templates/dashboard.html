{% extends 'base.html' %}

{% block title %}
  <title>
  Koi Dashboard
  </title>
{% endblock%}}

{% block body %}
   <div id="wrapper">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand"><a href="/">Koi</a></li>
                <li><a href="/dashboard">Main<span></span></a></li>
                <li><a href="/activity">Activity<span></span></a></li>
                <li><a href="/transfers">Transfer History<span></span></a></li>
                <li><a href="/optimize">Optimize<span></span></a></li>
                <li><a href="/logout">Log Out<span></span></a></li>
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-8">

                        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle"><i class="fa fa-arrows-h" aria-hidden="true"></i></a>
                      
                          <!-- Show flashed messages -->
                          {% with messages = get_flashed_messages() %}
                              {% for message in messages %}
                                  <div class="alert alert-warning">{{ message }}</div>
                              {% endfor %}
                          {% endwith %}

                        <div class="balance-chart">
                          <canvas id="donutChart"></canvas>
                          <div id="donutLegend" class="chart-legend"></div>
                        </div>
                        <script src="/static/js/donut.js"></script>
                  
                </div>
                <div class="row">
                  <input type="button" class="btn btn-info toggle-btn" value="Transfer Between Programs">
                  <input style="display: none" type="button" class="btn btn-info toggle-btn" value="Update Program Balance">

                  <section class="col-xs-4" id="balance-form-section">

                    <form id="update-balance-form" method="POST" autocomplete="off">

                      <div class="form-group">
                        <label for="program">Update </label>
                        <select class="form-control" name="program" id="program" placeholder="Select Program">
                          {% for program in programs | sort(attribute="program_name") %}
                            <option value="{{ program.program_id }}">{{ program.program_name }}</option>
                          {% endfor %}
                        </select>
                      </div>

                      <div class="form-group row">
                        <label class="col-2 col-form-label" for="current-balance">Balance: </label>
                        <div class="col-10">
                          <input class="form-control" type="number" name="balance" id="current-balance" min="0" max="1000000000" maxlength="10" placeholder="Enter Points" required>
                        </div>
                      </div>

                      <input type="reset" class="btn btn-info reset-btn" value="Reset">
                      <input type="submit" class="btn btn-info" value="Submit Button">

                    </form>
                  </section>

                  <section style="display: none" class="col-xs-4" id="transfer-form-section">

                    <form id="transfer-form" method="POST" autocomplete="off">
                      
                      <div class="form-group">
                        <label for="outgoing">Transfer From </label>
                        <select class="form-control" name="outgoing" id="outgoing" placeholder="Select Outgoing Program">
                          {% for program in outgoing %}
                            <option value="{{ program.outgoing_program }}">{{ program.outgoing.program_name }}</option>
                          {% endfor %}
                        </select>
                      </div>

                      <div class="form-group">
                        <label for="receiving">To </label>
                        <select class="form-control" name="receiving" id="receiving" placeholder="Select Receiving Program"></select>
                      </div>

                      <label id="ratio" hidden></label>
                      <br>

                      <div class="form-group row">
                        <label class="col-2 col-form-label" for="transfer-amount">Amount: </label>
                        <div class="col-10">
                          <input class="form-control" type="number" name="amount" id="transfer-amount" min="1" max="1000000000" maxlength="10" placeholder="Enter Points" required>
                        </div>
                      </div>

                      <input type="reset" class="btn btn-info reset-btn" value="Reset">
                      <input type="submit" class="btn btn-info" value="Submit Button">
                    </form>
                  </section>

                  <section class="col-xs-12">
                    <table class="table-hover table-striped" id="program-balance" style="display:none;" cellspacing="0" width="100%">
                      <tfoot>
                          <tr>
                              <th></th>
                              <th></th>
                              <th>Vendor</th>
                              <th>Program</th>
                              <th>Current Balance</th>
                              <th></th>
                          </tr>
                      </tfoot>
                    </table>
                  </section>
    </div>
  </div>
<!-- <script src="/static/js/balances.js"></script> -->
<script src="/static/js/dashboard_update.js"></script>
<script src="/static/js/dashboard_transfer.js"></script>

            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->
     <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>

{% endblock%}}
